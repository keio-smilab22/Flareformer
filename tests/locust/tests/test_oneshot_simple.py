from locust import HttpUser, task, between,TaskSet, constant
import datetime
import json

date_list = ["2010-09-24T03:00:00.000Z",
"2011-05-17T00:00:00.000Z",
"2017-04-30T19:00:00.000Z",
"2012-03-16T09:00:00.000Z",
"2013-09-15T12:00:00.000Z",
"2011-06-20T16:00:00.000Z",
"2011-07-24T11:00:00.000Z",
"2011-04-29T15:00:00.000Z",
"2014-01-08T19:00:00.000Z",
"2011-03-26T16:00:00.000Z",
"2013-04-16T02:00:00.000Z",
"2011-08-05T23:00:00.000Z",
"2013-04-03T04:00:00.000Z",
"2011-02-13T11:00:00.000Z",
"2015-06-24T15:00:00.000Z",
"2011-05-04T17:00:00.000Z",
"2013-08-22T04:00:00.000Z",
"2016-03-28T10:00:00.000Z",
"2017-12-17T01:00:00.000Z",
"2012-05-21T22:00:00.000Z",
"2014-12-28T08:00:00.000Z",
"2013-04-12T23:00:00.000Z",
"2010-11-11T09:00:00.000Z",
"2016-04-04T17:00:00.000Z",
"2015-05-14T01:00:00.000Z",
"2010-12-03T16:00:00.000Z",
"2013-07-07T08:00:00.000Z",
"2014-04-11T22:00:00.000Z",
"2014-05-08T22:00:00.000Z",
"2017-03-07T11:00:00.000Z",
"2014-02-20T17:00:00.000Z",
"2016-03-28T06:00:00.000Z",
"2012-11-13T13:00:00.000Z",
"2012-11-06T06:00:00.000Z",
"2012-07-07T09:00:00.000Z",
"2014-09-20T05:00:00.000Z",
"2016-04-19T16:00:00.000Z",
"2012-10-09T06:00:00.000Z",
"2015-08-20T01:00:00.000Z",
"2017-10-31T15:00:00.000Z",
"2013-10-05T06:00:00.000Z",
"2016-07-18T10:00:00.000Z",
"2014-06-04T15:00:00.000Z",
"2012-07-31T15:00:00.000Z",
"2011-04-22T07:00:00.000Z",
"2017-04-10T22:00:00.000Z",
"2011-03-03T23:00:00.000Z",
"2015-04-23T19:00:00.000Z",
"2012-05-20T04:00:00.000Z",
"2015-11-04T00:00:00.000Z",
"2010-06-25T14:00:00.000Z",
"2015-11-20T14:00:00.000Z",
"2012-12-24T00:00:00.000Z",
"2013-07-22T07:00:00.000Z",
"2010-11-26T11:00:00.000Z",
"2017-07-07T23:00:00.000Z",
"2012-02-26T16:00:00.000Z",
"2011-05-29T00:00:00.000Z",
"2011-02-01T16:00:00.000Z",
"2014-12-06T22:00:00.000Z",
"2013-12-07T18:00:00.000Z",
"2016-08-16T03:00:00.000Z",
"2012-11-22T18:00:00.000Z",
"2017-11-08T13:00:00.000Z",
"2010-08-11T06:00:00.000Z",
"2014-11-04T12:00:00.000Z",
"2013-07-28T15:00:00.000Z",
"2015-09-24T05:00:00.000Z",
"2013-11-01T09:00:00.000Z",
"2014-11-12T08:00:00.000Z",
"2016-09-28T00:00:00.000Z",
"2014-01-05T12:00:00.000Z",
"2015-04-04T23:00:00.000Z",
"2017-08-13T06:00:00.000Z",
"2014-09-28T20:00:00.000Z",
"2010-07-09T08:00:00.000Z",
"2011-06-13T23:00:00.000Z",
"2016-05-19T22:00:00.000Z",
"2016-10-18T13:00:00.000Z",
"2015-01-02T03:00:00.000Z",
"2013-03-10T11:00:00.000Z",
"2011-02-17T23:00:00.000Z",
"2014-08-22T08:00:00.000Z",
"2012-02-02T17:00:00.000Z",
"2017-09-21T06:00:00.000Z",
"2017-04-29T08:00:00.000Z",
"2014-01-25T07:00:00.000Z",
"2012-05-16T04:00:00.000Z",
"2015-04-02T17:00:00.000Z",
"2015-04-23T03:00:00.000Z",
"2012-07-29T14:00:00.000Z",
"2015-04-05T20:00:00.000Z",
"2017-10-13T04:00:00.000Z",
"2012-01-09T16:00:00.000Z",
"2017-12-11T16:00:00.000Z",
"2013-12-12T09:00:00.000Z",
"2015-12-18T10:00:00.000Z",
"2013-07-15T00:00:00.000Z",
"2017-08-07T12:00:00.000Z",
"2015-01-07T20:00:00.000Z"]

import random

class WebsiteUser(HttpUser):
    wait_time = constant(60)

    @task
    def test_oneshot_simple(self):        
        # rand_dates = random.choice(date_list)
        rand_dates = date_list[0]
        print(rand_dates)
        with self.client.get(f"/oneshot/simple?date={rand_dates}", catch_response=True) as response:
            response.status_code
            if response.status_code != 200:
                response.failure("statusCode is not 200")        # self.client.post(

        # dt_now = datetime.datetime.now()
        # print("dt_now:",dt_now)
        print("=====================")
        content = json.loads(response.content.decode())
        print(content["oneshot_status"])
        

        rand_dates = date_list.pop(0)
