==========================================
{'wandb_name': 'id13-4b_2014_with_mae', 'epochs': 40, 'lr': 7e-07, 'bs': 8, 'lambda': {'GMGS': 0.0001, 'BS': 10}, 'save_model_path': 'models/id1-4b.pth', 'dataset': {'window': 4, 'year_split': {'train': {'start': 2010, 'end': 2013}, 'valid': {'start': 2014, 'end': 2014}, 'test': {'start': 2014, 'end': 2014}}, 'mean': 91.0729, 'std': 57.5899, 'GMGS_score_matrix': [[0.32253222, -0.29649121, -0.66356076, -1], [-0.29649121, 0.42576394, 0.05869439, -0.27774485], [-0.66356076, 0.05869439, 3.68555451, 3.34911527], [-1, -0.27774485, 3.34911527, 39.45652268]], 'climatology': [0.9081, 0.0919]}, 'MM': {'N': 1, 'd_model': 128, 'h': 4, 'd_ff': 16, 'dropout': 0.1}, 'SFM': {'N': 1, 'd_model': 128, 'h': 4, 'd_ff': 16, 'dropout': 0.1}, 'input_channel': 90, 'output_channel': 4, 'main_metric': 'GMGS'}
==========================================
data/data_2010_label.csv
data/data_2011_label.csv
data/data_2012_label.csv
data/data_2013_label.csv
data/data_2010_feat.csv
data/data_2011_feat.csv
data/data_2012_feat.csv
data/data_2013_feat.csv
data/data_2010_window_48.csv
data/data_2011_window_48.csv
data/data_2012_window_48.csv
data/data_2013_window_48.csv
img: torch.Size([29247, 1, 256, 256]) label: (29247, 4) feat: (29247, 90) window: (29247, 4)
data/data_2014_label.csv
data/data_2014_feat.csv
data/data_2014_window_48.csv
img: torch.Size([8127, 1, 256, 256]) label: (8127, 4) feat: (8127, 90) window: (8127, 4)
data/data_2014_label.csv
data/data_2014_feat.csv
data/data_2014_window_48.csv
img: torch.Size([8127, 1, 256, 256]) label: (8127, 4) feat: (8127, 90) window: (8127, 4)
Batch Sampling
<All keys matched successfully>
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
FlareTransformerWithMAE                  --
├─InformerEncoderLayer: 1-1              --
│    └─AttentionLayer: 2-1               --
│    │    └─ProbAttention: 3-1           --
│    │    └─Linear: 3-2                  65,792
│    │    └─Linear: 3-3                  65,792
│    │    └─Linear: 3-4                  65,792
│    │    └─Linear: 3-5                  65,792
│    └─Conv1d: 2-2                       4,112
│    └─Conv1d: 2-3                       4,352
│    └─LayerNorm: 2-4                    512
│    └─LayerNorm: 2-5                    512
│    └─Dropout: 2-6                      --
├─InformerEncoderLayer: 1-2              --
│    └─AttentionLayer: 2-7               --
│    │    └─ProbAttention: 3-6           --
│    │    └─Linear: 3-7                  65,792
│    │    └─Linear: 3-8                  65,792
│    │    └─Linear: 3-9                  65,792
│    │    └─Linear: 3-10                 65,792
│    └─Conv1d: 2-8                       4,112
│    └─Conv1d: 2-9                       4,352
│    └─LayerNorm: 2-10                   512
│    └─LayerNorm: 2-11                   512
│    └─Dropout: 2-12                     --
├─CNNModel: 1-3                          --
│    └─Conv2d: 2-13                      784
│    └─BatchNorm2d: 2-14                 32
│    └─ReLU: 2-15                        --
│    └─MaxPool2d: 2-16                   --
│    └─Bottleneck: 2-17                  --
│    │    └─Conv2d: 3-11                 128
│    │    └─BatchNorm2d: 3-12            16
│    │    └─Conv2d: 3-13                 576
│    │    └─BatchNorm2d: 3-14            16
│    │    └─Conv2d: 3-15                 256
│    │    └─BatchNorm2d: 3-16            64
│    │    └─ReLU: 3-17                   --
│    │    └─Sequential: 3-18             576
│    └─AdaptiveAvgPool2d: 2-18           --
│    └─Flatten: 2-19                     --
│    └─Softmax: 2-20                     --
│    └─Linear: 2-21                      4,128
│    └─Linear: 2-22                      132
│    └─BatchNorm2d: 2-23                 64
│    └─Dropout: 2-24                     --
├─Linear: 1-4                            2,052
├─Linear: 1-5                            524,544
├─Softmax: 1-6                           --
├─Linear: 1-7                            262,400
├─Linear: 1-8                            262,400
├─ReLU: 1-9                              --
├─Linear: 1-10                           23,296
├─BatchNorm1d: 1-11                      8
=================================================================
Total params: 1,626,784
Trainable params: 1,626,784
Non-trainable params: 0
=================================================================
====== Epoch  0  ======
[[5775  848  498  189]
 [2471 1810 1330 1699]
 [ 944 1060 1412 3894]
 [ 287  488  310 6225]]
x:  0.5879160966712267
m:  0.5557455540355677
c:  0.621203830369357
[[1437  445  184  164]
 [1149 1490 1026  879]
 [  69  174  299  665]
 [   1    5   15  125]]
x:  0.6421561139212479
m:  0.48336930627539626
c:  0.43767933987867963
Epoch 0: Train loss:7.3588  Valid loss:7.9422 {'valid_ACC': 0.4123292727943891, 'valid_TSS-M': 0.48336930627539626, 'valid_BSS-M': -1.3593602845438788, 'valid_GMGS': 0.5210682533584413}
====== Epoch  1  ======
[[5945 1106  215   44]
 [1663 3241 1458  948]
 [ 567 1474 2462 2807]
 [  70  508  328 6404]]
x:  0.7028271773825809
m:  0.638577291381669
c:  0.708390332877337
[[1302  638  147  143]
 [ 900 1977  981  686]
 [  53  228  392  534]
 [   1    6   22  117]]
x:  0.6305892590793545
m:  0.4982409591387966
c:  0.42207932740749077
Epoch 1: Train loss:6.3676  Valid loss:7.6848 {'valid_ACC': 0.4661006521471638, 'valid_TSS-M': 0.4982409591387966, 'valid_BSS-M': -1.30172798099415, 'valid_GMGS': 0.5169698485418807}
====== Epoch  2  ======
[[5737 1331  205   37]
 [1460 3551 1522  777]
 [ 478 1570 2908 2354]
 [  22  451  309 6528]]
x:  0.7485636114911081
m:  0.6537619699042407
c:  0.6954400364797081
[[1229  726  149  126]
 [ 799 2149  982  614]
 [  48  247  447  465]
 [   1    6   30  109]]
x:  0.5955917564489636
m:  0.500589183764452
c:  0.40731914304681793
Epoch 2: Train loss:6.0536  Valid loss:7.5754 {'valid_ACC': 0.48406546080964685, 'valid_TSS-M': 0.500589183764452, 'valid_BSS-M': -1.2974847486269012, 'valid_GMGS': 0.5011666944200778}
====== Epoch  3  ======
[[5808 1257  214   31]
 [1413 3680 1500  717]
 [ 425 1562 3336 1987]
 [   4  397  286 6623]]
x:  0.7813041495668035
m:  0.6682626538987688
c:  0.7105335157318742
[[1252  732  134  112]
 [ 816 2210  983  535]
 [  49  268  468  422]
 [   1    7   44   94]]
x:  0.5098925015404737
m:  0.4993856122634018
c:  0.4145806448669271
Epoch 3: Train loss:5.7953  Valid loss:7.4375 {'valid_ACC': 0.4951396579303556, 'valid_TSS-M': 0.4993856122634018, 'valid_BSS-M': -1.1947010771277595, 'valid_GMGS': 0.4746195862236009}
====== Epoch  4  ======
[[5773 1284  230   23]
 [1355 3748 1591  616]
 [ 390 1552 3650 1718]
 [   1  307  231 6771]]
x:  0.8187870497036024
m:  0.6778385772913816
c:  0.7101231190150479
[[1248  732  160   90]
 [ 807 2211 1069  457]
 [  46  279  538  344]
 [   1    7   65   73]]
x:  0.38835985465480516
m:  0.491701346677691
c:  0.41482185591062104
Epoch 4: Train loss:5.5998  Valid loss:7.3810 {'valid_ACC': 0.5007998031253845, 'valid_TSS-M': 0.491701346677691, 'valid_BSS-M': -1.1828002397015966, 'valid_GMGS': 0.43162768574770577}
====== Epoch  5  ======
[[5831 1221  226   32]
 [1316 3864 1540  590]
 [ 359 1530 3919 1502]
 [   1  220  191 6898]]
x:  0.8467852257181943
m:  0.6923392612859097
c:  0.72124943000456
[[1172  776  169  113]
 [ 688 2264 1076  516]
 [  37  267  542  361]
 [   0    8   71   67]]
x:  0.3348595036499357
m:  0.4927553309674332
c:  0.402616668352305
Epoch 5: Train loss:5.4044  Valid loss:7.4837 {'valid_ACC': 0.497723637258521, 'valid_TSS-M': 0.4927553309674332, 'valid_BSS-M': -1.288995288597414, 'valid_GMGS': 0.41007716765655794}
====== Epoch  6  ======
[[5785 1268  226   31]
 [1285 3934 1535  556]
 [ 321 1554 4165 1270]
 [   0  162  143 7005]]
x:  0.8735978112175102
m:  0.7000683994528043
c:  0.7181486548107615
[[1211  743  182   94]
 [ 715 2243 1151  435]
 [  37  261  596  313]
 [   1    7   95   43]]
x:  0.18901998410608759
m:  0.4989613999529962
c:  0.41535728055080073
Epoch 6: Train loss:5.2249  Valid loss:7.4110 {'valid_ACC': 0.503629875722899, 'valid_TSS-M': 0.4989613999529962, 'valid_BSS-M': -1.2314119918605873, 'valid_GMGS': 0.36777955486996156}
====== Epoch  7  ======
[[5825 1245  196   44]
 [1272 3927 1625  486]
 [ 343 1527 4298 1142]
 [   0  122  127 7061]]
x:  0.8896944824441404
m:  0.7029411764705883
c:  0.7232102143182855
[[1216  758  182   74]
 [ 710 2288 1182  364]
 [  37  271  631  268]
 [   0    8  113   25]]
x:  0.08277278399211825
m:  0.500427812877855
c:  0.4186168995255625
Epoch 7: Train loss:5.0852  Valid loss:7.3269 {'valid_ACC': 0.5118740002460933, 'valid_TSS-M': 0.500427812877855, 'valid_BSS-M': -1.1615170348737849, 'valid_GMGS': 0.3339391654651786}
====== Epoch  8  ======
[[5878 1215  181   36]
 [1253 4026 1583  448]
 [ 316 1495 4480 1019]
 [   0   93  120 7097]]
x:  0.9023255813953488
m:  0.7160054719562243
c:  0.7325581395348837
[[1168  805  182   75]
 [ 645 2412 1147  340]
 [  33  288  633  253]
 [   0    8  117   21]]
x:  0.06013683182489919
m:  0.49938168437163877
c:  0.40879310069496455
Epoch 8: Train loss:4.9213  Valid loss:7.2795 {'valid_ACC': 0.5209794512120094, 'valid_TSS-M': 0.49938168437163877, 'valid_BSS-M': -1.131748389826331, 'valid_GMGS': 0.3227705389638342}
====== Epoch  9  ======
[[5884 1214  177   35]
 [1202 4098 1583  427]
 [ 302 1509 4636  863]
 [   0   61   90 7159]]
x:  0.9189238486092112
m:  0.7199726402188782
c:  0.736342909256726
[[1215  753  192   70]
 [ 700 2286 1230  328]
 [  37  258  662  250]
 [   0    8  120   18]]
x:  0.042094838254553194
m:  0.5073788720011364
c:  0.4198642465462792
Epoch 9: Train loss:4.7958  Valid loss:7.3699 {'valid_ACC': 0.5144579795742587, 'valid_TSS-M': 0.5073788720011364, 'valid_BSS-M': -1.1641053183687096, 'valid_GMGS': 0.32311265226732294}
====== Epoch  10  ======
[[5777 1293  202   38]
 [1236 4158 1563  353]
 [ 309 1459 4750  792]
 [   1   45   85 7179]]
x:  0.9281349749202006
m:  0.7284541723666211
c:  0.7197902416780666
[[1206  770  194   60]
 [ 677 2342 1219  306]
 [  36  272  664  235]
 [   0    7  120   19]]
x:  0.05483313966560993
m:  0.5045622462827415
c:  0.4198982381403937
Epoch 10: Train loss:4.7249  Valid loss:7.3053 {'valid_ACC': 0.5206103113079857, 'valid_TSS-M': 0.5045622462827415, 'valid_BSS-M': -1.120920408694864, 'valid_GMGS': 0.3264312080295817}
====== Epoch  11  ======
[[5888 1214  180   28]
 [1199 4183 1593  335]
 [ 290 1496 4821  703]
 [   2   30   73 7205]]
x:  0.9370269037847697
m:  0.7295485636114911
c:  0.7374829001367988
[[1200  786  201   43]
 [ 660 2322 1311  251]
 [  32  267  713  195]
 [   0    7  124   15]]
x:  0.0414692085483846
m:  0.5072283028168876
c:  0.42076878796013173
Epoch 11: Train loss:4.5807  Valid loss:7.3018 {'valid_ACC': 0.522948197366802, 'valid_TSS-M': 0.5072283028168876, 'valid_BSS-M': -1.1219995467054193, 'valid_GMGS': 0.323155433108468}
====== Epoch  12  ======
[[5833 1263  182   32]
 [1197 4233 1585  295]
 [ 270 1475 4927  638]
 [   2   31   68 7209]]
x:  0.9421796625626995
m:  0.7351573187414501
c:  0.7309621523027816
[[1236  766  195   33]
 [ 719 2290 1316  219]
 [  36  281  716  174]
 [   0    7  126   13]]
x:  0.03566432606206864
m:  0.5002723338289023
c:  0.4262288873798412
Epoch 12: Train loss:4.5061  Valid loss:7.2461 {'valid_ACC': 0.5235634305401747, 'valid_TSS-M': 0.5002723338289023, 'valid_BSS-M': -1.057719675237978, 'valid_GMGS': 0.32072184909027074}
====== Epoch  13  ======
[[5872 1220  184   34]
 [1168 4242 1602  298]
 [ 297 1438 5005  570]
 [   0   26   57 7227]]
x:  0.9475148198814409
m:  0.7346785225718194
c:  0.7364797081623347
[[1209  800  187   34]
 [ 681 2325 1305  233]
 [  31  282  709  185]
 [   0    7  125   14]]
x:  0.03925590400488832
m:  0.5038192200909044
c:  0.42141310737161336
Epoch 13: Train loss:4.4324  Valid loss:7.2515 {'valid_ACC': 0.5238095238095238, 'valid_TSS-M': 0.5038192200909044, 'valid_BSS-M': -1.0659046599901336, 'valid_GMGS': 0.32149607715580203}
====== Epoch  14  ======
[[5915 1220  146   29]
 [1139 4325 1598  248]
 [ 269 1394 5126  521]
 [   0   19   50 7241]]
x:  0.954172366621067
m:  0.7467168262653898
c:  0.7449612403100775
[[1279  773  159   19]
 [ 752 2449 1164  179]
 [  34  347  675  151]
 [   0    8  126   12]]
x:  0.03846292478883924
m:  0.48795577455734296
c:  0.44025448829723407
Epoch 14: Train loss:4.3192  Valid loss:6.9922 {'valid_ACC': 0.5432508920881014, 'valid_TSS-M': 0.48795577455734296, 'valid_BSS-M': -0.8530414654394457, 'valid_GMGS': 0.32222439588113877}
====== Epoch  15  ======
[[5911 1206  169   24]
 [1212 4290 1557  251]
 [ 267 1434 5123  486]
 [   0   18   29 7263]]
x:  0.9588691290469676
m:  0.7455540355677155
c:  0.7411764705882353
[[1233  794  181   22]
 [ 699 2359 1316  170]
 [  30  308  733  136]
 [   0    7  125   14]]
x:  0.05479280414271566
m:  0.4956753911689209
c:  0.4292926174363951
Epoch 15: Train loss:4.2901  Valid loss:7.1390 {'valid_ACC': 0.5338993478528362, 'valid_TSS-M': 0.4956753911689209, 'valid_BSS-M': -0.9852211600220787, 'valid_GMGS': 0.32658693758267726}
====== Epoch  16  ======
[[5929 1202  155   24]
 [1168 4386 1552  204]
 [ 261 1367 5231  451]
 [   0    8   16 7286]]
x:  0.9657546739626083
m:  0.7557455540355678
c:  0.7459188326493388
[[1240  801  174   15]
 [ 697 2433 1279  135]
 [  30  338  745   94]
 [   0    7  127   12]]
x:  0.05161917087328981
m:  0.48619804299339386
c:  0.4327707863921078
Epoch 16: Train loss:4.2021  Valid loss:7.0224 {'valid_ACC': 0.5450965916082195, 'valid_TSS-M': 0.48619804299339386, 'valid_BSS-M': -0.9059009383002372, 'valid_GMGS': 0.32352933341959716}
====== Epoch  17  ======
[[5897 1233  155   25]
 [1114 4415 1575  206]
 [ 246 1358 5314  392]
 [   0   12   20 7278]]
x:  0.9672138622891017
m:  0.7553351573187415
c:  0.74468764249886
[[1294  755  168   13]
 [ 769 2358 1292  125]
 [  34  338  742   93]
 [   0    7  126   13]]
x:  0.0600973545046197
m:  0.4839797661202314
c:  0.44409812392255393
Epoch 17: Train loss:4.1548  Valid loss:7.0493 {'valid_ACC': 0.5422665190107051, 'valid_TSS-M': 0.4839797661202314, 'valid_BSS-M': -0.8930835380631824, 'valid_GMGS': 0.32939174818246836}
====== Epoch  18  ======
[[5926 1200  157   27]
 [1164 4388 1549  209]
 [ 250 1308 5359  393]
 [   0   13   15 7282]]
x:  0.9674874601003192
m:  0.7597127222982216
c:  0.7461924304605563
[[1289  771  157   13]
 [ 745 2470 1207  122]
 [  31  377  706   93]
 [   0    8  125   13]]
x:  0.060473247249889714
m:  0.47124783229473327
c:  0.4464345707439597
Epoch 18: Train loss:4.1113  Valid loss:6.9341 {'valid_ACC': 0.5510028300725975, 'valid_TSS-M': 0.47124783229473327, 'valid_BSS-M': -0.8296151371749365, 'valid_GMGS': 0.32605188342952757}
====== Epoch  19  ======
[[5942 1197  143   28]
 [1079 4481 1563  187]
 [ 243 1309 5405  353]
 [   2   11    7 7290]]
x:  0.9713634290925672
m:  0.7615595075239399
c:  0.752485180118559
[[1228  805  183   14]
 [ 658 2422 1337  127]
 [  27  323  748  109]
 [   0    8  122   16]]
x:  0.07826464565672238
m:  0.49020056469990575
c:  0.434511886031584
Epoch 19: Train loss:4.0419  Valid loss:7.0927 {'valid_ACC': 0.5431278454534268, 'valid_TSS-M': 0.49020056469990575, 'valid_BSS-M': -0.9607452825652446, 'valid_GMGS': 0.3343256987960707}
====== Epoch  20  ======
[[5946 1192  151   21]
 [1128 4493 1521  168]
 [ 225 1272 5484  329]
 [   1    9    6 7294]]
x:  0.9741906064751482
m:  0.7696306429548563
c:  0.7516643866849065
[[1248  823  151    8]
 [ 684 2567 1195   98]
 [  29  397  705   76]
 [   0    8  124   14]]
x:  0.07308625107918978
m:  0.46488235636845454
c:  0.43873231885788244
Epoch 20: Train loss:3.9887  Valid loss:6.8612 {'valid_ACC': 0.5578934416143718, 'valid_TSS-M': 0.46488235636845454, 'valid_BSS-M': -0.7946029221461878, 'valid_GMGS': 0.3255669754351756}
====== Epoch  21  ======
[[5963 1212  116   19]
 [1092 4493 1538  187]
 [ 221 1254 5533  302]
 [   3    5    9 7293]]
x:  0.9745098039215686
m:  0.7713406292749658
c:  0.7557227542179662
[[1252  795  173   10]
 [ 685 2425 1323  111]
 [  28  353  734   92]
 [   0    8  123   15]]
x:  0.07605134111322609
m:  0.4737839410763864
c:  0.44052604083097663
Epoch 21: Train loss:3.9503  Valid loss:7.0322 {'valid_ACC': 0.5446044050695213, 'valid_TSS-M': 0.4737839410763864, 'valid_BSS-M': -0.9043759013535088, 'valid_GMGS': 0.330120441006863}
====== Epoch  22  ======
[[5927 1213  151   19]
 [1079 4579 1503  149]
 [ 228 1188 5610  284]
 [   0    4    6 7300]]
x:  0.9780209758321933
m:  0.7782489740082079
c:  0.7512083903328773
[[1264  792  165    9]
 [ 685 2433 1315  111]
 [  27  363  723   94]
 [   0    8  119   19]]
x:  0.10332330380544202
m:  0.4696416518879739
c:  0.44607678450165816
Epoch 22: Train loss:3.8882  Valid loss:7.0208 {'valid_ACC': 0.5462040113202904, 'valid_TSS-M': 0.4696416518879739, 'valid_BSS-M': -0.8950744613819857, 'valid_GMGS': 0.3396805800650247}
====== Epoch  23  ======
[[5936 1220  138   16]
 [1105 4485 1553  167]
 [ 209 1209 5625  267]
 [   1   11    4 7294]]
x:  0.9772913816689467
m:  0.7740082079343366
c:  0.7520747834017327
[[1293  752  173   12]
 [ 724 2412 1301  107]
 [  29  365  712  101]
 [   0    8  116   22]]
x:  0.12311946352038144
m:  0.4677186215456647
c:  0.4521285809992312
Epoch 23: Train loss:3.9006  Valid loss:7.0377 {'valid_ACC': 0.5462040113202904, 'valid_TSS-M': 0.4677186215456647, 'valid_BSS-M': -0.8981384707961331, 'valid_GMGS': 0.34765555535509246}
====== Epoch  24  ======
[[5975 1194  122   19]
 [1080 4597 1484  149]
 [ 205 1140 5714  251]
 [   0    2    2 7306]]
x:  0.9803465572275422
m:  0.7865253077975376
c:  0.7587779297765618
[[1280  771  171    8]
 [ 690 2463 1295   96]
 [  24  387  712   84]
 [   0    8  115   23]]
x:  0.1339783012050881
m:  0.4585492855492207
c:  0.4529125168912368
Epoch 24: Train loss:3.8163  Valid loss:6.9973 {'valid_ACC': 0.5510028300725975, 'valid_TSS-M': 0.4585492855492207, 'valid_BSS-M': -0.8850367344975494, 'valid_GMGS': 0.3484800345485152}
====== Epoch  25  ======
[[5959 1189  145   17]
 [1070 4643 1464  133]
 [ 203 1141 5732  234]
 [   1   10    4 7295]]
x:  0.9804377564979481
m:  0.7870041039671682
c:  0.7570907432740538
[[1283  772  167    8]
 [ 685 2498 1276   85]
 [  24  403  706   74]
 [   0    8  116   22]]
x:  0.12976023535348508
m:  0.4517429037725436
c:  0.4551056971280525
Epoch 25: Train loss:3.7912  Valid loss:6.9429 {'valid_ACC': 0.5548172757475083, 'valid_TSS-M': 0.4517429037725436, 'valid_BSS-M': -0.8549445752138181, 'valid_GMGS': 0.34553627875136045}
====== Epoch  26  ======
[[6013 1147  129   21]
 [1059 4597 1523  131]
 [ 194 1161 5744  211]
 [   1    9    3 7297]]
x:  0.9816689466484269
m:  0.7832421340629275
c:  0.765389876880985
[[1269  764  187   10]
 [ 680 2441 1334   89]
 [  24  383  714   86]
 [   0    8  113   25]]
x:  0.1480528240873444
m:  0.4541245154781848
c:  0.449675558979218
Epoch 26: Train loss:3.7559  Valid loss:7.0510 {'valid_ACC': 0.5474344776670358, 'valid_TSS-M': 0.4541245154781848, 'valid_BSS-M': -0.9226163453287881, 'valid_GMGS': 0.3506176328482491}
====== Epoch  27  ======
[[6003 1169  126   12]
 [1074 4640 1478  118]
 [ 191 1055 5845  219]
 [   3    4    1 7302]]
x:  0.9829913360693114
m:  0.7956908344733242
c:  0.7633834929320565
[[1257  791  171   11]
 [ 629 2534 1293   88]
 [  22  405  694   86]
 [   0    8  112   26]]
x:  0.15490213915583756
m:  0.44775707560602457
c:  0.45328201388408335
Epoch 27: Train loss:3.7105  Valid loss:6.9964 {'valid_ACC': 0.5550633690168574, 'valid_TSS-M': 0.44775707560602457, 'valid_BSS-M': -0.8928765254998188, 'valid_GMGS': 0.3519804095486485}
====== Epoch  28  ======
[[5961 1185  142   22]
 [1072 4644 1463  131]
 [ 182 1055 5877  196]
 [   0    4    2 7304]]
x:  0.983264933880529
m:  0.7948700410396716
c:  0.7582763337893297
[[1300  759  161   10]
 [ 706 2534 1225   79]
 [  25  431  666   85]
 [   0    8  112   26]]
x:  0.15628041255516095
m:  0.4393140722614248
c:  0.4589983049829244
Epoch 28: Train loss:3.7128  Valid loss:6.9109 {'valid_ACC': 0.5569090685369755, 'valid_TSS-M': 0.4393140722614248, 'valid_BSS-M': -0.8247035990203072, 'valid_GMGS': 0.3515309299331701}
====== Epoch  29  ======
[[6065 1132  104    9]
 [1047 4721 1446   96]
 [ 177 1069 5882  182]
 [   0    0    5 7305]]
x:  0.9862289101687186
m:  0.8015731874145007
c:  0.7738714090287278
[[1278  756  187    9]
 [ 669 2508 1293   74]
 [  22  427  684   74]
 [   0    9  109   28]]
x:  0.1721091015820107
m:  0.43075781470432467
c:  0.4559159441868671
Epoch 29: Train loss:3.6350  Valid loss:6.9667 {'valid_ACC': 0.5534637627660883, 'valid_TSS-M': 0.43075781470432467, 'valid_BSS-M': -0.8745548830721994, 'valid_GMGS': 0.3529276201577341}
====== Epoch  30  ======
[[5983 1186  131   10]
 [1053 4740 1400  117]
 [ 173  993 5957  187]
 [   2    3    1 7304]]
x:  0.9848609211126311
m:  0.8064979480164159
c:  0.7624715002279983
[[1318  745  161    6]
 [ 737 2538 1207   62]
 [  25  453  667   62]
 [   0   10  109   27]]
x:  0.16864282122094768
m:  0.4273330204112895
c:  0.46181314356847863
Epoch 30: Train loss:3.6206  Valid loss:6.8809 {'valid_ACC': 0.5598621877691645, 'valid_TSS-M': 0.4273330204112895, 'valid_BSS-M': -0.8056247416713831, 'valid_GMGS': 0.35259632840023863}
====== Epoch  31  ======
[[6005 1147  140   18]
 [1032 4776 1398  104]
 [ 169  980 5984  177]
 [   0    5    2 7303]]
x:  0.9854081167350661
m:  0.8075239398084815
c:  0.7667122663018696
[[1253  794  177    6]
 [ 607 2664 1208   65]
 [  17  469  656   65]
 [   0   22   96   28]]
x:  0.1747403507989008
m:  0.40959858910127867
c:  0.45606689119876265
Epoch 31: Train loss:3.5868  Valid loss:6.8997 {'valid_ACC': 0.5661375661375662, 'valid_TSS-M': 0.40959858910127867, 'valid_BSS-M': -0.8505168476490969, 'valid_GMGS': 0.3468019436996474}
====== Epoch  32  ======
[[6044 1127  126   13]
 [1052 4717 1418  123]
 [ 150  976 5999  185]
 [   3    6    2 7299]]
x:  0.9838577291381669
m:  0.8074555403556771
c:  0.7718650250797994
[[1271  768  183    8]
 [ 624 2553 1298   69]
 [  19  446  669   73]
 [   0   25   92   29]]
x:  0.17983549972280055
m:  0.4078447854290927
c:  0.4609166628011051
Epoch 32: Train loss:3.5795  Valid loss:7.0118 {'valid_ACC': 0.5564168819982773, 'valid_TSS-M': 0.4078447854290927, 'valid_BSS-M': -0.9168575686884971, 'valid_GMGS': 0.3495323159843327}
====== Epoch  33  ======
[[5976 1184  129   21]
 [1015 4844 1356   95]
 [ 150  952 6049  159]
 [   1    4    0 7305]]
x:  0.9867761057911536
m:  0.8147742818057456
c:  0.7643410852713177
[[1278  746  197    9]
 [ 643 2495 1334   72]
 [  19  436  673   79]
 [   0   31   85   30]]
x:  0.18543183897372698
m:  0.4028295222963502
c:  0.46083369897743853
Epoch 33: Train loss:3.5405  Valid loss:7.0973 {'valid_ACC': 0.5507567368032484, 'valid_TSS-M': 0.4028295222963502, 'valid_BSS-M': -0.9726001263807256, 'valid_GMGS': 0.3496983534158386}
====== Epoch  34  ======
[[6019 1156  125   10]
 [1028 4799 1378  105]
 [ 168  926 6060  156]
 [   0    6    1 7303]]
x:  0.9866849065207478
m:  0.8140902872777018
c:  0.7688554491564068
[[1288  745  187   10]
 [ 673 2522 1276   73]
 [  19  458  649   81]
 [   0   38   78   30]]
x:  0.18493064864670028
m:  0.3911388071123646
c:  0.4602306713682035
Epoch 34: Train loss:3.5274  Valid loss:7.0523 {'valid_ACC': 0.5523563430540175, 'valid_TSS-M': 0.3911388071123646, 'valid_BSS-M': -0.9341400550038286, 'valid_GMGS': 0.3454333757090895}
====== Epoch  35  ======
[[6076 1100  121   13]
 [1058 4822 1347   83]
 [ 155  886 6122  147]
 [   1    5    0 7304]]
x:  0.9880984952120383
m:  0.8214090287277702
c:  0.7758321933424532
[[1240  801  177   12]
 [ 575 2706 1191   72]
 [  14  493  616   84]
 [   0   44   71   31]]
x:  0.19127877338816673
m:  0.37840785525980714
c:  0.4561725160851721
Epoch 35: Train loss:3.4724  Valid loss:7.0024 {'valid_ACC': 0.5651531930601698, 'valid_TSS-M': 0.37840785525980714, 'valid_BSS-M': -0.9108898011744307, 'valid_GMGS': 0.341953048244382}
====== Epoch  36  ======
[[6010 1167  124    9]
 [1002 4853 1357   98]
 [ 149  883 6138  140]
 [   2    7    1 7300]]
x:  0.9873689010487916
m:  0.8201778385772913
c:  0.7695850433196535
[[1264  775  186    5]
 [ 625 2600 1261   58]
 [  16  476  647   68]
 [   0   46   75   25]]
x:  0.1548188935022047
m:  0.37945398376602335
c:  0.4581168048509883
Epoch 36: Train loss:3.4636  Valid loss:7.0222 {'valid_ACC': 0.5581395348837209, 'valid_TSS-M': 0.37945398376602335, 'valid_BSS-M': -0.9349867038505855, 'valid_GMGS': 0.33079656070640545}
====== Epoch  37  ======
[[6064 1119  114   13]
 [ 994 4872 1355   89]
 [ 145  871 6164  130]
 [   0    8    1 7301]]
x:  0.9881896944824442
m:  0.8225034199726402
c:  0.777610579115367
[[1273  765  184    8]
 [ 646 2644 1192   62]
 [  18  522  589   78]
 [   0   52   69   25]]
x:  0.15268883461234128
m:  0.34899056454933663
c:  0.45825239100827286
Epoch 37: Train loss:3.4337  Valid loss:7.0428 {'valid_ACC': 0.5575243017103482, 'valid_TSS-M': 0.34899056454933663, 'valid_BSS-M': -0.9403949779923566, 'valid_GMGS': 0.3199772633899836}
====== Epoch  38  ======
[[6023 1149  126   12]
 [1008 4906 1299   97]
 [ 151  848 6184  127]
 [   1    4    0 7305]]
x:  0.9885544915640675
m:  0.8264021887824897
c:  0.7710442316461468
[[1270  769  184    7]
 [ 638 2646 1198   62]
 [  17  511  604   75]
 [   0   51   68   27]]
x:  0.16688865507635428
m:  0.3578607261231642
c:  0.45843329929104326
Epoch 38: Train loss:3.4111  Valid loss:7.0408 {'valid_ACC': 0.5594930478651409, 'valid_TSS-M': 0.3578607261231642, 'valid_BSS-M': -0.9378850428801442, 'valid_GMGS': 0.3277275601635206}
====== Epoch  39  ======
[[6022 1149  124   15]
 [1025 4900 1299   86]
 [ 157  839 6185  129]
 [   1    4    2 7303]]
x:  0.9885544915640675
m:  0.8272913816689466
c:  0.769858641130871
[[1306  728  189    7]
 [ 699 2534 1250   61]
 [  22  495  616   74]
 [   0   52   69   25]]
x:  0.15344062010288131
m:  0.35698480626001206
c:  0.4633846654565558
Epoch 39: Train loss:3.4177  Valid loss:7.1285 {'valid_ACC': 0.5513719699766212, 'valid_TSS-M': 0.35698480626001206, 'valid_BSS-M': -0.9954052771955232, 'valid_GMGS': 0.3246033639398164}
========== TEST ===========
[[1437  445  184  164]
 [1149 1490 1026  879]
 [  69  174  299  665]
 [   1    5   15  125]]
x:  0.6421561139212479
m:  0.48336930627539626
c:  0.43767933987867963
epoch :  0 {'test_ACC': 0.4123292727943891, 'test_TSS-M': 0.48336930627539626, 'test_BSS-M': -1.359359587597082, 'test_GMGS': 0.5210682533584413}

