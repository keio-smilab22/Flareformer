==========================================
{'wandb_name': 'id13-4b_2014_with_mae', 'epochs': 40, 'lr': 7e-07, 'bs': 19, 'lambda': {'GMGS': 0.0001, 'BS': 10}, 'save_model_path': 'models/id1-4b.pth', 'dataset': {'window': 4, 'year_split': {'train': {'start': 2010, 'end': 2013}, 'valid': {'start': 2014, 'end': 2014}, 'test': {'start': 2014, 'end': 2014}}, 'mean': 91.0729, 'std': 57.5899, 'GMGS_score_matrix': [[0.32253222, -0.29649121, -0.66356076, -1], [-0.29649121, 0.42576394, 0.05869439, -0.27774485], [-0.66356076, 0.05869439, 3.68555451, 3.34911527], [-1, -0.27774485, 3.34911527, 39.45652268]], 'climatology': [0.9081, 0.0919]}, 'MM': {'N': 1, 'd_model': 128, 'h': 4, 'd_ff': 16, 'dropout': 0.1}, 'SFM': {'N': 1, 'd_model': 128, 'h': 4, 'd_ff': 16, 'dropout': 0.1}, 'input_channel': 90, 'output_channel': 4, 'main_metric': 'GMGS'}
==========================================
data/data_2010_label.csv
data/data_2011_label.csv
data/data_2012_label.csv
data/data_2013_label.csv
data/data_2010_feat.csv
data/data_2011_feat.csv
data/data_2012_feat.csv
data/data_2013_feat.csv
data/data_2010_window_48.csv
data/data_2011_window_48.csv
data/data_2012_window_48.csv
data/data_2013_window_48.csv
img: torch.Size([29247, 1, 256, 256]) label: (29247, 4) feat: (29247, 90) window: (29247, 4)
Calculating std :  0 / 1
Calculating std :  1 / 1
0.35716575 0.22504742444964324
data/data_2014_label.csv
data/data_2014_feat.csv
data/data_2014_window_48.csv
img: torch.Size([8127, 1, 256, 256]) label: (8127, 4) feat: (8127, 90) window: (8127, 4)
data/data_2014_label.csv
data/data_2014_feat.csv
data/data_2014_window_48.csv
img: torch.Size([8127, 1, 256, 256]) label: (8127, 4) feat: (8127, 90) window: (8127, 4)
Batch Sampling
<All keys matched successfully>
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
FlareTransformerReplacedViTWithMAE       --
├─InformerEncoderLayer: 1-1              --
│    └─AttentionLayer: 2-1               --
│    │    └─ProbAttention: 3-1           --
│    │    └─Linear: 3-2                  16,512
│    │    └─Linear: 3-3                  16,512
│    │    └─Linear: 3-4                  16,512
│    │    └─Linear: 3-5                  16,512
│    └─Conv1d: 2-2                       2,064
│    └─Conv1d: 2-3                       2,176
│    └─LayerNorm: 2-4                    256
│    └─LayerNorm: 2-5                    256
│    └─Dropout: 2-6                      --
├─InformerEncoderLayer: 1-2              --
│    └─AttentionLayer: 2-7               --
│    │    └─ProbAttention: 3-6           --
│    │    └─Linear: 3-7                  16,512
│    │    └─Linear: 3-8                  16,512
│    │    └─Linear: 3-9                  16,512
│    │    └─Linear: 3-10                 16,512
│    └─Conv1d: 2-8                       2,064
│    └─Conv1d: 2-9                       2,176
│    └─LayerNorm: 2-10                   256
│    └─LayerNorm: 2-11                   256
│    └─Dropout: 2-12                     --
├─CNNModel: 1-3                          --
│    └─Conv2d: 2-13                      784
│    └─BatchNorm2d: 2-14                 32
│    └─ReLU: 2-15                        --
│    └─MaxPool2d: 2-16                   --
│    └─Bottleneck: 2-17                  --
│    │    └─Conv2d: 3-11                 128
│    │    └─BatchNorm2d: 3-12            16
│    │    └─Conv2d: 3-13                 576
│    │    └─BatchNorm2d: 3-14            16
│    │    └─Conv2d: 3-15                 256
│    │    └─BatchNorm2d: 3-16            64
│    │    └─ReLU: 3-17                   --
│    │    └─Sequential: 3-18             576
│    └─AdaptiveAvgPool2d: 2-18           --
│    └─Flatten: 2-19                     --
│    └─Softmax: 2-20                     --
│    └─Linear: 2-21                      4,128
│    └─Linear: 2-22                      132
│    └─BatchNorm2d: 2-23                 64
│    └─Dropout: 2-24                     --
├─Linear: 1-4                            1,028
├─Linear: 1-5                            131,200
├─Softmax: 1-6                           --
├─Linear: 1-7                            65,664
├─Linear: 1-8                            65,664
├─ReLU: 1-9                              --
├─Linear: 1-10                           11,648
├─BatchNorm1d: 1-11                      8
├─MaskedAutoencoderViT: 1-12             --
│    └─PatchEmbed: 2-25                  --
│    │    └─Conv2d: 3-19                 32,896
│    └─ModuleList: 2-26                  --
│    │    └─Block: 3-20                  198,272
│    │    └─Block: 3-21                  198,272
│    │    └─Block: 3-22                  198,272
│    │    └─Block: 3-23                  198,272
│    │    └─Block: 3-24                  198,272
│    │    └─Block: 3-25                  198,272
│    │    └─Block: 3-26                  198,272
│    │    └─Block: 3-27                  198,272
│    │    └─Block: 3-28                  198,272
│    │    └─Block: 3-29                  198,272
│    │    └─Block: 3-30                  198,272
│    │    └─Block: 3-31                  198,272
│    │    └─Block: 3-32                  198,272
│    │    └─Block: 3-33                  198,272
│    │    └─Block: 3-34                  198,272
│    │    └─Block: 3-35                  198,272
│    │    └─Block: 3-36                  198,272
│    │    └─Block: 3-37                  198,272
│    │    └─Block: 3-38                  198,272
│    │    └─Block: 3-39                  198,272
│    │    └─Block: 3-40                  198,272
│    │    └─Block: 3-41                  198,272
│    │    └─Block: 3-42                  198,272
│    │    └─Block: 3-43                  198,272
│    └─LayerNorm: 2-27                   256
│    └─Linear: 2-28                      66,048
│    └─ModuleList: 2-29                  --
│    │    └─Block: 3-44                  3,152,384
│    │    └─Block: 3-45                  3,152,384
│    │    └─Block: 3-46                  3,152,384
│    │    └─Block: 3-47                  3,152,384
│    │    └─Block: 3-48                  3,152,384
│    │    └─Block: 3-49                  3,152,384
│    │    └─Block: 3-50                  3,152,384
│    │    └─Block: 3-51                  3,152,384
│    └─LayerNorm: 2-30                   1,024
│    └─Linear: 2-31                      131,328
=================================================================
Total params: 30,632,736
Trainable params: 30,632,736
Non-trainable params: 0
=================================================================
====== Epoch  0  ======
